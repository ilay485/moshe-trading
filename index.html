<!DOCTYPE html>
<html lang="he">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>הוראות יומיות</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg,#1DB954,#191414);
    color: #fff;
    margin: 0;
    padding: 0;
    direction: rtl;
}
.container { max-width: 480px; margin: auto; padding: 20px; }
h1,h2 { text-align: center; margin-bottom: 20px; font-weight: 700; }
input, textarea { width: 100%; padding: 14px; margin: 8px 0; border-radius: 30px; border: none; font-size: 16px; outline: none; }
textarea { resize: none; height: 100px; }
button { width: 100%; padding: 14px; background: #191414; color: #1DB954; font-size: 16px; border: 2px solid #1DB954; border-radius: 30px; cursor: pointer; margin: 10px 0; transition: all 0.3s ease; }
button:hover { background: #1DB954; color: #191414; font-weight: bold; }
/* פאנל אדמין - מוסתר כברירת מחדל */
#adminPanel { display: none !important; margin-top: 20px; padding: 20px; background: rgba(0,0,0,0.5); border-radius: 20px; }
/* הוראות היום */
#instructions { margin-top: 20px; }
ul { list-style: none; padding: 0; }
li { background: rgba(0,0,0,0.3); margin: 10px 0; padding: 15px; border-radius: 20px; font-size: 16px; display: flex; align-items: center; }
li i { margin-left: 10px; color: #1DB954; }
/* מובייל */
@media(max-width:500px){ h1,h2{ font-size: 1.5em; } input, textarea, button { font-size: 14px; padding: 12px; } }
</style>
</head>
<body>

<div class="container">
    <h1>הוראות יומיות</h1>

    <!-- התחברות -->
    <div id="loginDiv">
        <input type="email" id="email" placeholder="אימייל">
        <input type="password" id="password" placeholder="סיסמה">
        <button onclick="login()"><i class="fas fa-right-to-bracket"></i> התחבר</button>
    </div>

    <!-- פאנל אדמין -->
    <div id="adminPanel">
        <h2>פאנל אדמין</h2>
        <textarea id="newInstruction" placeholder="כתוב את ההוראה כאן..."></textarea>
        <button onclick="addInstruction()"><i class="fas fa-plus"></i> הוסף הוראה</button>
    </div>

    <!-- הוראות היום -->
    <div id="instructions">
        <h2>הוראות היום</h2>
        <ul id="instructionsList"></ul>
    </div>
</div>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyBZHoP1FhaKBX0AcK7tc0g8uzpri9IIKsI",
    authDomain: "capital-market-app-ec814.firebaseapp.com",
    projectId: "capital-market-app-ec814",
    storageBucket: "capital-market-app-ec814.firebasestorage.app",
    messagingSenderId: "309964966513",
    appId: "1:309964966513:web:5efd82a505e7f0f58e29d0",
    measurementId: "G-029WT6XYBW"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// רשימת אדמינים
const adminEmails = ["ilaybs2211@gmail.com"];

// הסתר פאנל ברגע טעינת הדף
document.getElementById("adminPanel").style.display = "none";

function login() {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value;
    auth.signInWithEmailAndPassword(email, password)
        .then(() => console.log("התחברת בהצלחה:", email))
        .catch(error => alert("שגיאה בהתחברות: " + error.message));
}

// מאזין למצב המשתמש
auth.onAuthStateChanged(user => {
    const panel = document.getElementById("adminPanel");
    if(user){
        const email = user.email.trim();
        if(adminEmails.includes(email)){
            panel.style.display = "block"; // רק למורשים
            console.log("פאנל האדמין מוצג ✅");
        } else {
            panel.style.display = "none";
        }
        loadInstructions();
    } else {
        panel.style.display = "none"; // אף אחד לא מחובר
        console.log("אף אחד לא מחובר ❌");
    }
});

// הוספת הוראה
function addInstruction() {
    const text = document.getElementById("newInstruction").value.trim();
    if(text === "") return alert("כתוב הוראה לפני ההוספה");
    const today = new Date().toISOString().split("T")[0];
    db.collection("instructions").doc(today).set({ text })
        .then(() => {
            alert("הוראה נוספה בהצלחה!");
            document.getElementById("newInstruction").value = "";
            loadInstructions();
        })
        .catch(error => alert("שגיאה בהוספת הוראה: " + error.message));
}

// טעינת הוראות היום
function loadInstructions() {
    const today = new Date().toISOString().split("T")[0];
    db.collection("instructions").doc(today).get()
        .then(doc => {
            const list = document.getElementById("instructionsList");
            list.innerHTML = "";
            const li = document.createElement("li");
            li.innerHTML = doc.exists ? `<i class="fas fa-circle"></i> ${doc.data().text}` : `<i class="fas fa-circle"></i> אין הוראות להיום`;
            list.appendChild(li);
        });
}
</script>

</body>
</html>





